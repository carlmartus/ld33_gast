function esFullFrame(e,n){var i=document.getElementById(e);i.style="padding: 0px; margin: 0px; position: absolute; left: 0px; top: 0px;";var t=function(){var e=window.innerWidth,t=window.innerHeight;i.width=e,i.height=t,n(e,t)};window.addEventListener("resize",t,!1),t()}
function esInitGl(e,t){var n=document.getElementById(e),i=null;try{i=n.getContext("webgl",t)}catch(o){}if(null==i)try{i=n.getContext("experimental-webgl",t)}catch(o){}return i}function esInitSw(e){var t=document.getElementById(e);return t.getContext("2d")}function esNextFrame(e){function t(){var i=Date.now();e(.001*(i-n))||requestAnimationFrame(t),n=i}var n=Date.now();requestAnimationFrame=window&&window.requestAnimationFrame?window.requestAnimationFrame:function(e){window.setTimeout(e,1e3/60)},requestAnimationFrame(t)}
function esLoad(){this.list=[]}function renderGlLoadingScreen(e,r,t){var o=e.getParameter(e.VIEWPORT),a=o[0],n=o[1],L=o[2],_=o[3];e.clearColor(0,0,0,1),e.clear(e.COLOR_BUFFER_BIT),e.enable(e.SCISSOR_TEST),e.scissor(a+GLLOD_BG,n+_/2-GLLOD_BG,L-2*GLLOD_BG,2*GLLOD_BG),e.clearColor(.5,.5,.5,1),e.clear(e.COLOR_BUFFER_BIT),e.scissor(a+(GLLOD_BG+(GLLOD_BG-GLLOD_FG)),n+_/2-GLLOD_FG,r/t*(L-2*(GLLOD_BG+(GLLOD_BG-GLLOD_FG))),2*GLLOD_FG),e.clearColor(1,1,1,1),e.clear(e.COLOR_BUFFER_BIT),e.disable(e.SCISSOR_TEST),e.viewport(a,n,L,_)}var ES_LOAD_IMAGE=1,ES_LOAD_AUDIO=2,ES_LOAD_TEXTURE=3,GLLOD_BG=16,GLLOD_FG=12;esLoad.prototype.loadImage=function(e){var r=new Image;return this.list.push([r,e,ES_LOAD_IMAGE]),r},esLoad.prototype.loadTexture=function(e,r,t,o,a){var n=e.createTexture();return this.list.push([n,r,ES_LOAD_TEXTURE]),e.bindTexture(e.TEXTURE_2D,n),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MAG_FILTER,t),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MIN_FILTER,t),a&&e.generateMipmap(e.TEXTURE_2D),n},esLoad.prototype.loadAudio=function(e){var r=new Audio;return this.list.push([r,e,ES_LOAD_AUDIO]),r},esLoad.prototype.downloadWithGlScreen=function(e,r){return renderGlLoadingScreen(e,0,1),this.download(r,function(r,t){renderGlLoadingScreen(e,r,t)},e)},esLoad.prototype.download=function(e,r,t){for(var o=this.list.length,a=o,n=0;n<this.list.length;n++){var L=this.list[n],_=L[0],E=L[1],i=L[2],s=function(t,n){return function(){a--,r&&r(o-a,o),0==a&&e()}}(_,E);switch(i){default:case ES_LOAD_IMAGE:_.onload=s,_.src=E;break;case ES_LOAD_AUDIO:_.addEventListener("canplaythrough",s,!1),_.src=E;break;case ES_LOAD_TEXTURE:var G=new Image;G.onload=function(e,r){t.bindTexture(t.TEXTURE_2D,_),t.texImage2D(t.TEXTURE_2D,0,t.RGBA,t.RGBA,t.UNSIGNED_BYTE,G),s(e,r)},G.src=E}}};
function esVec2_create(){return new Float32Array([0,0])}function esVec2_parse(e,t){return new Float32Array([e,t])}function esVec2_add(e,t,n){e[0]=t[0]+n[0],e[1]=t[1]+n[1]}function esVec2_sub(e,t,n){e[0]=t[0]-n[0],e[1]=t[1]-n[1]}function esVec2_mulk(e,t,n){e[0]=n*t[0],e[1]=n*t[1]}function esVec2_length(e){return Math.sqrt(e[0]*e[0]+e[1]*e[1])}function esVec2_dot(e,t){return e[0]*t[0]+e[1]*t[1]}function esVec2_isZero(e){return 0==e[0]&&0==e[1]}function esVec2_orthogonal(e,t){e[0]=t[1],e[1]=-t[0]}function esVec2_normalize(e,t,n){var c=1/esVec2_length(t);n&&(c*=n),e[0]=c*t[0],e[1]=c*t[1]}function esVec3_create(){return new Float32Array([0,0,0])}function esVec3_parse(e,t,n){return new Float32Array([e,t,n])}function esVec3_add(e,t,n){e[0]=t[0]+n[0],e[1]=t[1]+n[1],e[2]=t[2]+n[2]}function esVec3_sub(e,t,n){e[0]=t[0]-n[0],e[1]=t[1]-n[1],e[2]=t[2]-n[2]}function esVec3_mulk(e,t,n){e[0]=n*t[0],e[1]=n*t[1],e[2]=n*t[2]}function esVec3_length(e){return Math.sqrt(e[0]*e[0]+e[1]*e[1]+e[2]*e[2])}function esVec3_dot(e,t){return e[0]*t[0]+e[1]*t[1]+e[2]*t[2]}function esVec3_isZero(e){return 0==e[0]&&0==e[1]&&0==e[2]}function esVec3_cross(e,t,n){e[0]=t[1]*n[2]-t[2]*n[1],e[1]=t[2]*n[0]-t[0]*n[2],e[2]=t[0]*n[1]-t[1]*n[0]}function esVec3_normalize(e,t,n){var c=1/esVec3_length(t);n&&(c*=n),e[0]=c*t[0],e[1]=c*t[1],e[2]=c*t[2]}function esMat4_create(){return new Float32Array([0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0])}function esMat4_identity(e){e[0]=1,e[1]=e[2]=e[3]=0,e[5]=1,e[4]=e[6]=e[7]=0,e[10]=1,e[8]=e[9]=e[11]=0,e[15]=1,e[12]=e[13]=e[14]=0}function esMat4_mul(e,t,n){e[0]=n[0]*t[0]+n[1]*t[4]+n[2]*t[8]+n[3]*t[12],e[1]=n[0]*t[1]+n[1]*t[5]+n[2]*t[9]+n[3]*t[13],e[2]=n[0]*t[2]+n[1]*t[6]+n[2]*t[10]+n[3]*t[14],e[3]=n[0]*t[3]+n[1]*t[7]+n[2]*t[11]+n[3]*t[15],e[4]=n[4]*t[0]+n[5]*t[4]+n[6]*t[8]+n[7]*t[12],e[5]=n[4]*t[1]+n[5]*t[5]+n[6]*t[9]+n[7]*t[13],e[6]=n[4]*t[2]+n[5]*t[6]+n[6]*t[10]+n[7]*t[14],e[7]=n[4]*t[3]+n[5]*t[7]+n[6]*t[11]+n[7]*t[15],e[8]=n[8]*t[0]+n[9]*t[4]+n[10]*t[8]+n[11]*t[12],e[9]=n[8]*t[1]+n[9]*t[5]+n[10]*t[9]+n[11]*t[13],e[10]=n[8]*t[2]+n[9]*t[6]+n[10]*t[10]+n[11]*t[14],e[11]=n[8]*t[3]+n[9]*t[7]+n[10]*t[11]+n[11]*t[15],e[12]=n[12]*t[0]+n[13]*t[4]+n[14]*t[8]+n[15]*t[12],e[13]=n[12]*t[1]+n[13]*t[5]+n[14]*t[9]+n[15]*t[13],e[14]=n[12]*t[2]+n[13]*t[6]+n[14]*t[10]+n[15]*t[14],e[15]=n[12]*t[3]+n[13]*t[7]+n[14]*t[11]+n[15]*t[15]}function esMat4_ortho(e,t,n,c,r){e[1]=e[2]=e[3]=e[4]=e[6]=e[7]=e[8]=e[9]=0,e[0]=2/(c-t),e[5]=2/(r-n),e[10]=1,e[15]=1,e[12]=-(c+t)/(c-t),e[13]=-(r+n)/(r-n),e[14]=0}function esMat4_lookAt(e,t,n,c){var r=esVec3_create();esVec3_sub(r,n,t);var a=esVec3_create();esVec3_normalize(a,r);var s=esVec3_create();esVec3_cross(s,c,a);var o=esVec3_create();esVec3_normalize(o,s);var _=esVec3_create();esVec3_cross(_,a,o);var u=esMat4_create();esMat4_identity(u),u[0]=o[0],u[4]=o[1],u[8]=o[2],u[1]=_[0],u[5]=_[1],u[9]=_[2],u[2]=-a[0],u[6]=-a[1],u[10]=-a[2];var i=esMat4_create();esMat4_identity(i),i[12]=-t[0],i[13]=-t[1],i[14]=-t[2],esMat4_mul(e,u,i)}function esMat4_perspective(e,t,n,c,r){var a=c*Math.tan(.5*t),s=-a,o=a,_=-a/n,u=a/n;e[0]=2*c/(o-s),e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=2*c/(u-_),e[6]=0,e[7]=0,e[8]=(o+s)/(o-s),e[9]=(u+_)/(u-_),e[10]=-(r+c)/(r-c),e[11]=-1,e[12]=0,e[13]=0,e[14]=-(2*r*c)/(r-c),e[15]=0}function esMat4_camera(e,t,n,c,r,a,s,o){var _=esMat4_create();esMat4_perspective(_,t,n,c,r);var u=esMat4_create();esMat4_lookAt(u,a,s,o),esMat4_mul(e,_,u)}
function esProgram(r){this.gl=r,this.program=r.createProgram()}function compileShader(r,t,e){e=e==ES_VERTEX?r.VERTEX_SHADER:r.FRAGMENT_SHADER;var o=r.createShader(e);return r.shaderSource(o,t),r.compileShader(o),r.getShaderParameter(o,r.COMPILE_STATUS)||alert(r.getShaderInfoLog(o)),o}var ES_VERTEX=1,ES_FRAGMENT=2;esProgram.prototype.bindAttribute=function(r,t){this.gl.bindAttribLocation(this.program,r,t)},esProgram.prototype.addShaderId=function(r,t){this.addShaderText(document.getElementById(r).text,t)},esProgram.prototype.addShaderText=function(r,t){this.gl.attachShader(this.program,compileShader(this.gl,r,t))},esProgram.prototype.getUniform=function(r){return this.gl.getUniformLocation(this.program,r)},esProgram.prototype.link=function(){this.gl.linkProgram(this.program)},esProgram.prototype.use=function(){this.gl.useProgram(this.program)};